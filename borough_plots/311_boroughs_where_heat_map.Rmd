---
title: "R Notebook"
# output: html_notebook
---

# Load
```{r}
library(ggplot2)
library(ggmap)

df <- read.csv("../data/311_feb.csv")
```

# Generate Map
```{r}
ny_plot <- ggmap(get_map('New York City', zoom=11, maptype='terrain'))
ny_stat_density <- stat_density2d(data=df, aes(x = df$Longitude, y = df$Latitude, alpha=.6, fill=..level..), bins = 10, geom = 'polygon', na.rm=TRUE)
```

# Plot
```{r, fig.height=10, fig.width=10}
my_theme <- theme(plot.title = element_text(family = "Helvetica", face = "bold", size = (20), hjust = 0.5), 
                    plot.subtitle=element_text(family = "Helvetica", face = "bold", size = (25)),
                    axis.text.x = element_text(angle = 0, hjust = .5),
                    legend.title = element_text(face = "bold.italic", family = "Helvetica", size=20), 
                    legend.text = element_text(face = "italic", family = "Helvetica", size=13), 
                    axis.title = element_text(family = "Helvetica", size = (20)),
                    axis.text = element_text(family = "Courier", size = (13)))

ny_plot +
 ny_stat_density + 
  guides(fill = guide_colorbar(barwidth = 2, barheight = 12)) +
  scale_alpha(range = c(0, 0.5), guide = FALSE) + 
  xlab('') +
  ylab('') +
  scale_fill_viridis(begin=1, end=0) + 
  theme_bw() + 
  ggtitle(
    expression(
      atop("Where Do Complaints Occur", 
           atop("EXPLORING THE FREQUENCY OF COMPLAINTS GEOGRAPHICALLY", ""))
      )
    ) + 
  my_theme
```

