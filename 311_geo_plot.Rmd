---
title: "R Notebook"
# output: html_notebook
---

```{r}
library(ggplot2)
library(ggmap)
```

```{r}
df <- read.csv("data/311_feb.csv")
```

```{r}
df_geo_data <- df[, c("Latitude", "Longitude")]
# write.csv(df_geo_data, row.names=F, file = "311_geo_data.csv")
```

```{r}
ny_plot <- ggmap(get_map('New York City', zoom=11, maptype='terrain'))

ny_stat_density <- stat_density2d(data=df_heat_map(), aes(x = df$Longitude, y = df$Latitude, alpha=.6, fill=..level..), bins = 10, geom = 'polygon', na.rm=TRUE)

p <- ny_plot +
      ny_stat_density + 
      guides(fill = guide_colorbar(barwidth = 2, barheight = 20)) +
      scale_fill_gradient(low = "green", high = "red") +
      scale_alpha(range = c(0, 0.5), guide = FALSE) + 
      xlab('') +
      ylab('') +
      theme_bw() +
      theme(
        plot.title = element_text(colour = "grey28", family = "Helvetica", face = "bold", size = (20))
      ) + 
      ggtitle(
        expression(
          atop("Where Do Complaints Occur", 
               atop("EXPLORING THE FREQUENCY OF COMPLAINTS GEOGRAPHICALLY", ""))
        )
      )

p
```

